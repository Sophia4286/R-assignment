---
title: "DS311 - R Lab Assignment"
author: "Xuefei Li"
date: "11/8/2022"
output:
  html_document:
    theme: united
    highlight: tango
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Assignment 1

* In this assignment, we are going to apply some of the build in data set in R for descriptive statistics analysis.
* To earn full grade in this assignment, students need to complete the coding tasks for each question to get the result.
* After finished all the questions, knit the document into HTML format for submission.

### Question 1

Using the **mtcars** data set in R, please answer the following questions.

```{r}
# Loading the data
data(mtcars)

# Head of the data set
head(mtcars)
```

a. Report the number of variables and observations in the data set.

```{r}
# Enter your code here!
dim(mtcars)

# Answer:
print("There are total of 11 variables and 32 observations in this data set.")
```



b. Print the summary statistics of the data set and report how many discrete and continuous variables are in the data set.

```{r}
# Enter your code here!
summary(mtcars)


# Answer:
print("There are 5 discrete variables and 6 continuous variables in this data set.")
```



c. Calculate the mean, variance, and standard deviation for the variable **mpg** and assign them into variable names m, v, and s. Report the results in the print statement.

```{r}
# Enter your code here!
m <- mean(mtcars$mpg)
v <- var(mtcars$mpg)
s <- sd(mtcars$mpg)
m
v
s
print(paste("The average of Mile Per Gallon from this data set is ", 20.09062 , " with variance ", 36.3241 , " and standard deviation", 6.026948 , "."))
```



d. Create two tables to summarize 1) average mpg for each cylinder class and 2) the standard deviation of mpg for each gear class.

```{r}
# Enter your code here!
mpg_cyl_4 <- mean(mtcars$mpg[mtcars$cyl==4])
mpg_cyl_6 <- mean(mtcars$mpg[mtcars$cyl==6])
mpg_cyl_8 <- mean(mtcars$mpg[mtcars$cyl==8])

average_mpg <- c(mpg_cyl_4,mpg_cyl_6,mpg_cyl_8)
average_mpg 

cyl_class <- c(4,6,8)
cyl_class
table_1 <- data.frame(average_mpg,cyl_class)
table_1

mpg_gear_3 <- sd(mtcars$mpg[mtcars$gear==3])
mpg_gear_4 <- sd(mtcars$mpg[mtcars$gear==4])
mpg_gear_5 <- sd(mtcars$mpg[mtcars$gear==3])

mpg_gear_3
mpg_gear_4
mpg_gear_5

sd_mpg <- c(mpg_gear_3,mpg_gear_4,mpg_gear_5)
sd_mpg 
gear_class <- c(3,4,5)
gear_class
table_2 <- data.frame(sd_mpg,gear_class)
table_2


```



e. Create a crosstab that shows the number of observations belong to each cylinder and gear class combinations. The table should show how many observations given the car has 4 cylinders with 3 gears, 4 cylinders with 4 gears, etc. Report which combination is recorded in this data set and how many observations for this type of car.

```{r}
# Enter your code here!
nrow(mtcars[mtcars$cyl==4 & mtcars$gear==3,])
nrow(mtcars[mtcars$cyl==4 & mtcars$gear==4,])
nrow(mtcars[mtcars$cyl==4 & mtcars$gear==5,])
nrow(mtcars[mtcars$cyl==6 & mtcars$gear==3,])
nrow(mtcars[mtcars$cyl==6 & mtcars$gear==4,])
nrow(mtcars[mtcars$cyl==6 & mtcars$gear==5,])
nrow(mtcars[mtcars$cyl==8 & mtcars$gear==3,])
nrow(mtcars[mtcars$cyl==8 & mtcars$gear==4,])
nrow(mtcars[mtcars$cyl==8 & mtcars$gear==5,])

print("The most common car type in this data set is car with 8 cylinders and 3 gears. There are total of 12 cars belong to this specification in the data set.")
```


*** 

### Question 2

Use different visualization tools to summarize the data sets in this question.

a. Using the **PlantGrowth** data set, visualize and compare the weight of the plant in the three separated group. Give labels to the title, x-axis, and y-axis on the graph. Write a paragraph to summarize your findings.

```{r}
# Load the data set
data("PlantGrowth")

# Head of the data set
head(PlantGrowth)

# Enter your code here!

plot(PlantGrowth$group,PlantGrowth$weight,xlab="group",ylab="weight")

print("The tree 'ctrl' has a median value of weight that is about 5.2, which mean 50% of  data of 'ctrl' on weiht is below 5.2 and 50% of data of 'ctrl'on weight is  above 5.2. The The tree 'trl1' has a median value of weight that is about 4.7, which mean 50% of  data of 'trl1' on weiht is below 4.7 and 50% of data of 'trl1'on weight is above 4.7.The tree 'trl2' has a median value of weight that is about 5.5, which mean 50% of  data of 'ctrl' on weiht is below 5.5 and 50% of data of 'ctrl'on weight is above5.5  ")

```

Result:

=> Report a paragraph to summarize your findings from the plot!



b. Using the **mtcars** data set, plot the histogram for the column **mpg** with 10 breaks. Give labels to the title, x-axis, and y-axis on the graph. Report the most observed mpg class from the data set.

```{r}
hist(mtcars$mpg,main="mpg Histogram", xlab='mpg')

print("Most of the cars in this data set are in the class of 15-20 mile per gallon.")
```



c. Using the **USArrests** data set, create a pairs plot to display the correlations between the variables in the data set. Plot the scatter plot with **Murder** and **Assault**. Give labels to the title, x-axis, and y-axis on the graph. Write a paragraph to summarize your results from both plots.

```{r}
# Load the data set
data("USArrests")

# Head of the data set
head(USArrests)

# Enter your code here!
plot( USArrests$Murder, USArrests$Assault, main = "case of Murder vs. case of of Assault")

print("there is a positive relationship between number of Murder and the number of Assault. The bigger the cases of murder a state has, the bigger case of assulater gets")

```

Result:

=> Report a paragraph to summarize your findings from the plot!



***

### Question 3

Download the housing data set from www.jaredlander.com and find out what explains the housing prices in New York City.

Note: Check your working directory to make sure that you can download the data into the data folder. 

```{r, echo=FALSE}
# Load and clean the housing data set 
download.file(url='https://www.jaredlander.com/data/housing.csv',
              destfile='data/housing.csv', mode='wb')
housingData <- read.csv('data/housing.csv')
housingData <- subset(housingData, 
                      select = c("Neighborhood", "Market.Value.per.SqFt", "Boro", "Year.Built"))
housingData <- na.omit(housingData)                   
```

a. Create your own descriptive statistics and aggregation tables to summarize the data set and find any meaningful results between different variables in the data set.

```{r}
# Head of the cleaned data set
head(housingData)

# Enter your code here!

summary(housingData)

```

b. Create multiple plots to demonstrates the correlations between different variables. Remember to label all axes and give title to each graph.

```{r}
# Enter your code here!
plot( housingData$Market.Value.per.SqFt, housingData$year.Built, main = "year.built&Market.price")


```

c. Write a summary about your findings from this exercise.

```{r}
#Enter your answer here!
print("The Market.Value.per.SqFt had a midian of 114.89 and has mean 133.17. The mean there is a positive relationship between number of Market.Value.per.SqFt and the number of Assault. The older the houses, the higher Market.Value.per.SqFt of the houses" )
```

